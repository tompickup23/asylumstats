---
import BaseLayout from "../layouts/BaseLayout.astro";
import asylumFinance from "../data/live/asylum-finance.json";
---

<BaseLayout title="Methodology | asylumstats">
  <section class="page-head">
    <span class="kicker">Methodology</span>
    <h1>Tell users what is known, what is estimated, and what is only publicly evidenced.</h1>
    <p>
      This product has to be stricter than a normal dashboard because it mixes official releases with public hotel evidence and later archive recoveries.
    </p>
  </section>

  <section class="story-grid section">
    <article class="story-card">
      <h3>Official</h3>
      <p class="lede">Published Home Office, ONS, NAO, or parliamentary sources with stable release or document provenance.</p>
    </article>
    <article class="story-card">
      <h3>Derived estimate</h3>
      <p class="lede">Rates, tariff estimates, or calculated shares built from published source inputs and documented methods.</p>
    </article>
    <article class="story-card">
      <h3>Archive-derived</h3>
      <p class="lede">Recovered historical regional material that must always keep archive URL, capture date, and validation notes.</p>
    </article>
    <article class="story-card">
      <h3>Public evidence</h3>
      <p class="lede">Council statements, FOIs, planning records, or parliamentary material that help identify hotel sites or hotel presence.</p>
    </article>
  </section>

  <section class="section">
    <h2>Rules this prototype assumes</h2>
    <div class="story-grid">
      <article class="story-card">
        <h3>Never imply the hotel list is complete</h3>
        <p class="lede">Named hotels are a public-evidence ledger, not an official estate register.</p>
      </article>
      <article class="story-card">
        <h3>Separate spend families</h3>
        <p class="lede">National spend, tariff-based estimates, and local manual evidence should never be merged into one clean-looking line.</p>
      </article>
      <article class="story-card">
        <h3>Differentiate route, scheme, and status</h3>
        <p class="lede">Small boat arrivals, asylum support, refugee resettlement, refugee family reunion, and Ukraine routes should not be collapsed into one bucket.</p>
      </article>
      <article class="story-card">
        <h3>Public spending must pass a route test</h3>
        <p class="lede">Whole-council budgets, procurement feeds, and transaction corpora are context only unless a row explicitly ties back to a route or scheme.</p>
      </article>
      <article class="story-card">
        <h3>Keep release streams separate</h3>
        <p class="lede">National asylum chapters and local authority tables update on different schedules and should not be flattened into one update date.</p>
      </article>
      <article class="story-card">
        <h3>Integrity claims need document trails</h3>
        <p class="lede">Owner, operator, and supplier risk signals belong in the product, but only after the site-to-entity link and the documentary chain are strong enough to publish.</p>
      </article>
      <article class="story-card">
        <h3>Separate owner, operator, and prime provider</h3>
        <p class="lede">A hotel owner, a hotel operator, and the regional asylum accommodation prime can all be different entities. The site should keep those roles distinct instead of flattening them into one supplier label.</p>
      </article>
    </div>
  </section>

  <section class="section">
    <h2>Route scope classes</h2>
    <div class="story-grid">
      {asylumFinance.scopeRules.map((rule) => (
        <article class="story-card">
          <div class="chip-row">
            <span class={`chip ${rule.id === "route_specific" ? "accent" : rule.id === "local_route_relevant" ? "teal" : ""}`}>
              {rule.label}
            </span>
          </div>
          <p class="lede">{rule.description}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section">
    <h2>Public inclusion test</h2>
    <div class="story-grid">
      {asylumFinance.inclusionTests.map((rule) => (
        <article class="story-card">
          <p class="lede">{rule}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section">
    <h2>Route families the site should split</h2>
    <div class="story-grid">
      {asylumFinance.routeFamilies.map((route) => (
        <article class="story-card">
          <h3>{route.label}</h3>
          <p class="lede">{route.note}</p>
          <p class="tiny">{route.group} | {route.schemeStatus}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section">
    <h2>Hotel entity-resolution rule</h2>
    <div class="story-grid">
      <article class="story-card">
        <h3>Documented</h3>
        <p class="lede">Use this only when the ledger can tie a site to both owner-side and operator-side entities with a strong public source trail.</p>
      </article>
      <article class="story-card">
        <h3>Partial</h3>
        <p class="lede">Use this when one side of the chain is known, such as an owner group or operator brand, but the full site-level entity picture is still incomplete.</p>
      </article>
      <article class="story-card">
        <h3>Unresolved</h3>
        <p class="lede">Use this when a hotel is publicly named but the starter ledger still lacks a publishable owner or operator match. That is a transparency finding, not a reason to hide the row.</p>
      </article>
    </div>
  </section>

  <section class="section">
    <h2>Money-ledger display rule</h2>
    <div class="story-grid">
      <article class="story-card">
        <h3>Prime contract scope</h3>
        <p class="lede">These rows show who controls a region or visible set of current sites. They are not automatically a disclosed contract value.</p>
      </article>
      <article class="story-card">
        <h3>Funding instruction</h3>
        <p class="lede">These rows can be tariff rates or guidance components. They should not be shown as actual spend totals unless multiplied through with transparent placement counts and method notes.</p>
      </article>
      <article class="story-card">
        <h3>Scrutiny and cost rows</h3>
        <p class="lede">These rows are valuable accountability facts, but they belong in a distinct display state from contracts and tariffs.</p>
      </article>
    </div>
  </section>
</BaseLayout>
