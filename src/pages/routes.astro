---
import BaseLayout from "../layouts/BaseLayout.astro";
import PageContents from "../components/PageContents.astro";
import RegionTileMap from "../components/RegionTileMap.astro";
import TrendChart from "../components/TrendChart.astro";
import {
  asylumSystemReadingRules,
  buildSupportedAsylumStockDescription,
  supportedAsylumReadingRules
} from "../lib/asylum-support-logic";
import { loadLocalRouteLatest, loadRouteDashboard } from "../lib/route-data";
import { getRegionPressureSummaries, getSeriesDelta } from "../lib/route-analytics";

const routeDashboard = loadRouteDashboard();
const localRouteLatest = loadLocalRouteLatest();
const routeSignalCards = routeDashboard.nationalCards.slice(0, 3);
const featuredRoutes = [...routeDashboard.routeFamilies]
  .sort((a, b) => b.latestValue - a.latestValue)
  .slice(0, 3);
const featuredRouteIds = new Set(featuredRoutes.map((route) => route.id));
const remainingRoutes = routeDashboard.routeFamilies.filter((route) => !featuredRouteIds.has(route.id));
const illegalMethods = [...routeDashboard.illegalEntryMethodsLatestYear].sort((a, b) => b.value - a.value);
const decisionGroups = [...routeDashboard.smallBoatDecisionGroupsLatestYear.rows].sort((a, b) => b.value - a.value);
const maxMethodValue = Math.max(...illegalMethods.map((row) => row.value), 1);
const maxOutcomeValue = Math.max(...decisionGroups.map((row) => row.value), 1);
const stockFlowReadingRules = [...supportedAsylumReadingRules, ...asylumSystemReadingRules];
const nationalSystemDynamics = routeDashboard.nationalSystemDynamics;
const stockFlowCards = nationalSystemDynamics.stockFlowCards;
const latestQuarter = nationalSystemDynamics.latestQuarter;
const latestQuarterDecisionBreakdown = nationalSystemDynamics.latestQuarterDecisionBreakdown;
const latestSupportBreakdown = nationalSystemDynamics.latestSupportBreakdown;
const recentOutcomeCohorts = nationalSystemDynamics.recentOutcomeCohorts;
const postDecisionPath = nationalSystemDynamics.postDecisionPath;
const latestAppealDeterminationBreakdown = postDecisionPath.appeals.latestDeterminationBreakdown;
const latestReturnsBreakdown = postDecisionPath.returns.latestBreakdown;
const maxLatestDecisionBreakdownValue = Math.max(...latestQuarterDecisionBreakdown.map((row) => row.value), 1);
const maxLatestSupportBreakdownValue = Math.max(...latestSupportBreakdown.map((row) => row.value), 1);
const maxLatestAppealBreakdownValue = Math.max(...latestAppealDeterminationBreakdown.map((row) => row.value), 1);
const maxLatestReturnsBreakdownValue = Math.max(...latestReturnsBreakdown.map((row) => row.value), 1);
const leadPressureMetric =
  routeDashboard.topAreasByMetric.find((metric) => metric.metricId === "supportedAsylum") ??
  routeDashboard.topAreasByMetric[0];
const pressureLeader = leadPressureMetric?.rows[0];
const regionalPressure = getRegionPressureSummaries(localRouteLatest.areas);
const leadingRegionByTotal = regionalPressure[0];
const leadingRegionByRate = [...regionalPressure].sort((a, b) => b.supportedAsylumRate - a.supportedAsylumRate)[0];
const routeFindingCards = [
  {
    title: "Support and backlog are not the same stock",
    body: `${latestQuarter.supportedAsylum.toLocaleString()} people were on asylum support at quarter end while ${latestQuarter.awaitingInitialDecision.toLocaleString()} were still awaiting an initial decision. Those measures overlap without matching.`
  },
  {
    title: "Claims and decisions were moving on different tracks",
    body: `In ${latestQuarter.quarterLabel ?? "the latest quarter"}, ${latestQuarter.initialDecisions.toLocaleString()} initial decisions ${latestQuarter.decisionMinusClaims >= 0 ? "ran ahead of" : "trailed"} ${latestQuarter.claims.toLocaleString()} claims by ${Math.abs(latestQuarter.decisionMinusClaims).toLocaleString()}.`
  },
  {
    title: "Post-decision exits are still split across lagged systems",
    body: `Appeals data is only complete through ${postDecisionPath.appeals.dataCompleteThroughLabel ?? "an older quarter"}, while returns run to ${postDecisionPath.returns.latestQuarterLabel ?? "the latest quarter"} but cover all returns, not just asylum-specific exits.`
  }
];
const routeSections = [
  { id: "route-findings", label: "Findings" },
  { id: "route-logic", label: "How to read" },
  { id: "national-stock-flow", label: "Stock vs flow" },
  { id: "claims-support-tracks", label: "Tracks" },
  { id: "post-decision-path", label: "Post-decision" },
  { id: "route-splits", label: "Route splits" },
  { id: "route-trends", label: "Trends" },
  { id: "regional-pressure", label: "Region map" },
  { id: "local-pressure-leaders", label: "Local leaders" },
  { id: "route-limits", label: "Limits" }
];

function formatCardValue(value: number, suffix?: string): string {
  return suffix ? `${value}${suffix}` : value.toLocaleString();
}
---

<BaseLayout
  title="Routes | asylumstats"
  description="Official UK asylum route and scheme data covering asylum support, small boats, refugee pathways, and local pressure comparisons."
>
  <section class="page-top">
    <section class="page-head">
      <span class="kicker">Routes and schemes</span>
      <h1>Boat arrivals, asylum support, refugee schemes, family reunion, and Ukraine routes have to stay split.</h1>
      <p>
        This page now runs on official December 2025 route tables and the latest local-authority immigration-group
        snapshot. The product rule is simple: stop mixing incompatible routes and schemes into one misleading number,
        and treat supported asylum as a stock snapshot rather than a throughput count or a synonym for the backlog.
      </p>
    </section>

    <aside class="page-rail">
      <article class="panel panel-pad">
        <span class="tiny">National route signals</span>
        <p class="rail-copy">
          The core public mistake is not lack of data. It is the habit of collapsing asylum support, legal schemes,
          and illegal entry routes into one emotional metric.
        </p>
        <div class="stat-strip">
          {routeSignalCards.map((item) => (
            <article class="stat-tile">
              <span class="tiny">{item.label}</span>
              <strong>{formatCardValue(item.value, item.valueSuffix)}</strong>
              <p class="tiny">{item.period}</p>
            </article>
          ))}
        </div>
      </article>

      {pressureLeader && (
        <article class="panel panel-pad">
          <span class="tiny">Local pressure leader</span>
          <h2 class="rail-title">{pressureLeader.areaName}</h2>
          <p class="rail-copy">
            {pressureLeader.value.toLocaleString()} people on {leadPressureMetric.label.toLowerCase()} in the latest
            official local snapshot.
          </p>
          <div class="chip-row">
            <span class="chip accent">{leadPressureMetric.label}</span>
            <span class="chip">{pressureLeader.regionName}</span>
          </div>
        </article>
      )}
    </aside>
  </section>

  <PageContents title="Jump to evidence" sections={routeSections} variant="priority" />

  <section id="route-findings" class="section section-anchor priority-section">
    <div class="section-head">
      <div>
        <h2>What matters first</h2>
        <p class="lede">
          In {latestQuarter.quarterLabel ?? "the latest quarter"}, {latestQuarter.claims.toLocaleString()} asylum claims were lodged and {latestQuarter.initialDecisions.toLocaleString()} initial decisions were made, while {latestQuarter.awaitingInitialDecision.toLocaleString()} people were still awaiting an initial decision and {latestQuarter.supportedAsylum.toLocaleString()} were on asylum support at quarter end.
        </p>
      </div>
      <span class="chip accent">Stock and flow stay split</span>
    </div>
    <div class="story-grid">
      {routeFindingCards.map((card) => (
        <article class="story-card">
          <h3>{card.title}</h3>
          <p class="lede">{card.body}</p>
        </article>
      ))}
    </div>
  </section>

  <section id="route-logic" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>How to read asylum stock, flow, and churn</h2>
        <p class="lede">
          This site keeps claims, initial decisions, awaiting-decision stock, and supported asylum stock in separate
          lanes. That matters because steady local counts can still hide heavy turnover when new people enter support
          as others leave it.
        </p>
      </div>
      <span class="chip accent">Core logic</span>
    </div>
    <div class="story-grid">
      {stockFlowReadingRules.map((rule) => (
        <article class="story-card">
          <h3>{rule.title}</h3>
          <p class="lede">{rule.body}</p>
        </article>
      ))}
    </div>
  </section>

  <section id="national-stock-flow" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>National stock vs flow</h2>
        <p class="lede">
          Claims and initial decisions are quarterly flows. Awaiting an initial decision and receiving asylum support
          are quarter-end stock counts. They interact, but they are not the same measure.
        </p>
      </div>
      <span class="chip accent">{latestQuarter.quarterLabel ?? "Latest quarter"}</span>
    </div>
    <div class="stat-strip">
      {stockFlowCards.map((item) => (
        <article class="stat-tile">
          <span class="tiny">{item.label}</span>
          <strong>{formatCardValue(item.value, item.valueSuffix)}</strong>
          <p class="tiny">{item.period}</p>
        </article>
      ))}
    </div>
    <div class="story-grid" style="margin-top: 1rem;">
      {nationalSystemDynamics.readingNotes.map((note) => (
        <article class="story-card">
          <p class="lede">{note}</p>
        </article>
      ))}
    </div>
  </section>

  <section id="claims-support-tracks" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Claims, decisions, backlog, and support move on different tracks</h2>
        <p class="lede">
          These recent series show why a fall in the backlog, a rise in decisions, and a flat support line should not
          be collapsed into one story.
        </p>
      </div>
    </div>
    <div class="viz-grid">
      <TrendChart
        points={nationalSystemDynamics.flowSeries.claims.map((point) => ({ label: point.periodLabel, value: point.value }))}
        title="Asylum claims"
        description="Quarterly inflow into the asylum system."
        tone="accent"
      />
      <TrendChart
        points={nationalSystemDynamics.flowSeries.initialDecisions.map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Initial decisions"
        description="Quarterly operational output. This is not the same thing as latest cohort outcomes."
        tone="warm"
      />
      <TrendChart
        points={nationalSystemDynamics.stockSeries.awaitingInitialDecision.map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Awaiting initial decision"
        description="Quarter-end stock of people waiting for an initial decision."
        tone="teal"
      />
      <TrendChart
        points={nationalSystemDynamics.stockSeries.supportedAsylum.map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Supported asylum stock"
        description={buildSupportedAsylumStockDescription(latestQuarter.stockPeriodLabel ?? routeDashboard.localSnapshotDate)}
        tone="accent"
      />
    </div>
  </section>

  <section class="split section">
    <div class="panel panel-pad">
      <h2>Latest quarter decision mix</h2>
      <p class="lede">
        In {latestQuarter.quarterLabel ?? "the latest quarter"}, initial decisions {latestQuarter.decisionMinusClaims >= 0 ? "exceeded" : "trailed"} claims by{" "}
        {Math.abs(latestQuarter.decisionMinusClaims).toLocaleString()}. That operational balance does not track a
        single cohort one-for-one.
      </p>
      {latestQuarterDecisionBreakdown.map((row) => (
        <div class="metric-bar">
          <div style="min-width: 12rem;">
            <strong>{row.label}</strong>
            <div class="tiny">{row.value.toLocaleString()}</div>
          </div>
          <div class="metric-track">
            <div class="metric-fill" style={`width: ${(row.value / maxLatestDecisionBreakdownValue) * 100}%`}></div>
          </div>
        </div>
      ))}
    </div>

    <div class="panel panel-pad">
      <h2>Latest support stock mix</h2>
      <p class="lede">
        As at {latestQuarter.stockPeriodLabel ?? routeDashboard.localSnapshotDate}, hotel accommodation accounted for{" "}
        {latestQuarter.hotelShareOfSupportPct ?? 0}% of the published support stock.
      </p>
      {latestSupportBreakdown.map((row) => (
        <div class="metric-bar">
          <div style="min-width: 12rem;">
            <strong>{row.label}</strong>
            <div class="tiny">{row.value.toLocaleString()}</div>
          </div>
          <div class="metric-track">
            <div class="metric-fill" style={`width: ${(row.value / maxLatestSupportBreakdownValue) * 100}%`}></div>
          </div>
        </div>
      ))}
    </div>
  </section>

  <section class="section">
    <div class="section-head">
      <div>
        <h2>Claim cohorts resolve over time</h2>
        <p class="lede">
          Initial decisions are the operational read. Latest outcomes by claim year show what changed later after
          appeals or subsequent case progression.
        </p>
      </div>
      <span class="chip accent">Claim-year cohorts</span>
    </div>
    <div class="viz-grid">
      <TrendChart
        points={nationalSystemDynamics.outcomeRateSeries.initialGrantRate.map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Initial grant rate"
        description="Estimated grant rate at initial decision for the most recent claim-year cohorts."
        tone="warm"
        valueSuffix="%"
      />
      <TrendChart
        points={nationalSystemDynamics.outcomeRateSeries.latestGrantRate.map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Latest grant rate"
        description="Estimated latest grant rate for the same claim-year cohorts after later case progression."
        tone="teal"
        valueSuffix="%"
      />
    </div>
    <div class="feature-grid" style="margin-top: 1rem;">
      {recentOutcomeCohorts.map((cohort) => (
        <article class="feature-card">
          <div class="chip-row">
            <span class="chip accent">Claim year {cohort.claimYear}</span>
            <span class="chip">{cohort.latestOutcomeKnownPct ?? 0}% latest outcomes known</span>
          </div>
          <h3>{cohort.totalClaims.toLocaleString()} claims in the {cohort.claimYear} cohort</h3>
          <div class="data-list">
            <div class="data-row">
              <span>Initial grant rate</span>
              <span class="data-row-value">{cohort.initialGrantRatePct ?? "n/a"}%</span>
            </div>
            <div class="data-row">
              <span>Latest grant rate</span>
              <span class="data-row-value">{cohort.latestGrantRatePct ?? "n/a"}%</span>
            </div>
            <div class="data-row">
              <span>Latest outcome coverage</span>
              <span class="data-row-value">{cohort.latestOutcomeKnownPct ?? "n/a"}%</span>
            </div>
            <div class="data-row">
              <span>Initial withdrawals</span>
              <span class="data-row-value">{cohort.initialWithdrawalCount.toLocaleString()}</span>
            </div>
          </div>
        </article>
      ))}
    </div>
  </section>

  <section class="section section-anchor" id="post-decision-path">
    <div class="section-head">
      <div>
        <h2>Post-decision path</h2>
        <p class="lede">
          After an initial refusal or other case progression, some claims move through appeals and some people later
          leave the UK. The public data here has to stay split again: appeals are asylum-specific but lag badly, while
          current returns are broader than asylum-only exits.
        </p>
      </div>
      <div class="chip-row">
        <span class="chip accent">Appeals complete to {postDecisionPath.appeals.dataCompleteThroughLabel ?? "n/a"}</span>
        <span class="chip">{postDecisionPath.returns.latestQuarterLabel ?? "Latest quarter"} all-returns series</span>
      </div>
    </div>
    <div class="viz-grid">
      <TrendChart
        points={(postDecisionPath.appeals.series.lodged ?? []).map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Asylum appeals lodged"
        description={postDecisionPath.appeals.dataLagNote}
        tone="warm"
      />
      <TrendChart
        points={(postDecisionPath.appeals.series.determined ?? []).map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title="Asylum appeals determined"
        description="Quarterly tribunal-stage output within the asylum-specific appeals dataset."
        tone="teal"
      />
      <TrendChart
        points={(postDecisionPath.returns.series.total ?? []).map((point) => ({
          label: point.periodLabel,
          value: point.value
        }))}
        title={postDecisionPath.returns.scopeLabel}
        description={postDecisionPath.returns.scopeNote}
        tone="accent"
      />
    </div>
    <div class="split section" style="margin-top: 1rem;">
      <div class="panel panel-pad">
        <h3>Latest appeals mix</h3>
        <p class="lede">
          In {postDecisionPath.appeals.latestQuarterLabel ?? "the latest appeals quarter"}, asylum appeals data shows
          the tribunal-stage mix below. This is still an older operational view than the main December 2025 asylum
          release.
        </p>
        {latestAppealDeterminationBreakdown.map((row) => (
          <div class="metric-bar">
            <div style="min-width: 12rem;">
              <strong>{row.label}</strong>
              <div class="tiny">{row.value.toLocaleString()}</div>
            </div>
            <div class="metric-track">
              <div class="metric-fill" style={`width: ${(row.value / maxLatestAppealBreakdownValue) * 100}%`}></div>
            </div>
          </div>
        ))}
      </div>

      <div class="panel panel-pad">
        <h3>Latest returns mix</h3>
        <p class="lede">
          In {postDecisionPath.returns.latestQuarterLabel ?? "the latest returns quarter"}, the current all-returns
          series was led by voluntary returns, with enforced returns and refused-entry departures shown separately.
          This is not an asylum-only denominator.
        </p>
        {latestReturnsBreakdown.map((row) => (
          <div class="metric-bar">
            <div style="min-width: 12rem;">
              <strong>{row.label}</strong>
              <div class="tiny">{row.value.toLocaleString()}</div>
            </div>
            <div class="metric-track">
              <div class="metric-fill" style={`width: ${(row.value / maxLatestReturnsBreakdownValue) * 100}%`}></div>
            </div>
          </div>
        ))}
      </div>
    </div>
    <div class="story-grid" style="margin-top: 1rem;">
      {postDecisionPath.readingNotes.map((note) => (
        <article class="story-card">
          <p class="lede">{note}</p>
        </article>
      ))}
    </div>
  </section>

  <section id="route-splits" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Where the split matters most</h2>
        <p class="lede">
          These route families are the fastest way to show why one-number storytelling breaks the public picture.
        </p>
      </div>
      <span class="chip">{routeDashboard.routeFamilies.length} route families tracked</span>
    </div>
    <div class="feature-grid">
      {featuredRoutes.map((route) => (
        <article class="feature-card accent">
          <div class="chip-row">
            <span class="chip accent">{route.group}</span>
            <span class="chip">{route.latestPeriod}</span>
          </div>
          <h3>{route.label}</h3>
          <p class="metric-value">{route.latestValue.toLocaleString()}</p>
          <p class="lede">{route.note}</p>
          <div class="data-list">
            <div class="data-row">
              <span>Scheme status</span>
              <span class="data-row-value">{route.schemeStatus}</span>
            </div>
            <div class="data-row">
              <span>Local breakdown</span>
              <span class="data-row-value">{route.localBreakdown}</span>
            </div>
          </div>
          <p class="tiny">
            <a class="source-pill" href={route.sourceUrl}>Source</a>
          </p>
        </article>
      ))}
    </div>
  </section>

  <section id="route-trends" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Tracked route trends</h2>
        <p class="lede">
          The featured route families now have full static trend charts so users can see direction, not just the latest
          annual value.
        </p>
      </div>
    </div>
    <div class="viz-grid">
      {featuredRoutes.map((route, index) => {
        const delta = getSeriesDelta(route.series);
        const tone = index === 0 ? "accent" : index === 1 ? "warm" : "teal";
        return (
          <TrendChart
            points={route.series.map((point) => ({ label: point.periodLabel, value: point.value }))}
            title={route.label}
            description={
              route.id === "asylum_support"
                ? buildSupportedAsylumStockDescription(route.latestPeriod)
                : route.series.length > 1
                ? `${route.firstPeriod ?? route.series[0].periodLabel} to ${route.latestPeriod}. Last annual move: ${delta >= 0 ? "+" : ""}${delta.toLocaleString()}.`
                : `Latest observed value in ${route.latestPeriod}.`
            }
            tone={tone}
          />
        );
      })}
    </div>
  </section>

  <section class="split section section-anchor" id="regional-entry-patterns">
    <div class="panel panel-pad">
      <h2>Illegal entry routes in the latest year</h2>
      <p class="lede">Different entry methods carry different operational and policy questions. They should not blur.</p>
      {illegalMethods.map((row) => (
        <div class="metric-bar">
          <div style="min-width: 12rem;">
            <strong>{row.method}</strong>
            <div class="tiny">{row.value.toLocaleString()}</div>
          </div>
          <div class="metric-track">
            <div class="metric-fill" style={`width: ${(row.value / maxMethodValue) * 100}%`}></div>
          </div>
        </div>
      ))}
    </div>

    <div class="panel panel-pad">
      <h2>Small-boat asylum decision groups</h2>
      <p class="lede">
        Arrival cohorts for {routeDashboard.smallBoatDecisionGroupsLatestYear.year}. Decision outcomes need their own
        view, not a single arrivals headline.
      </p>
      {decisionGroups.map((row) => (
        <div class="metric-bar">
          <div style="min-width: 11rem;">
            <strong>{row.outcomeGroup}</strong>
            <div class="tiny">{row.value.toLocaleString()}</div>
          </div>
          <div class="metric-track">
            <div class="metric-fill" style={`width: ${(row.value / maxOutcomeValue) * 100}%`}></div>
          </div>
        </div>
      ))}
    </div>
  </section>

  <section id="regional-pressure" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Regional pressure map</h2>
        <p class="lede">
          National route families eventually resolve into regional concentration. Totals and rates tell slightly
          different stories, so both belong on the page.
        </p>
      </div>
      <span class="chip">{localRouteLatest.snapshotDate} local snapshot</span>
    </div>
    <div class="viz-grid">
      <RegionTileMap
        items={regionalPressure.map((region) => ({ regionName: region.regionName, value: region.supportedAsylum }))}
        title="Supported asylum by region"
        description={`${leadingRegionByTotal.regionName} currently carries the largest total supported asylum count.`}
        valueLabel="total people"
        highlightRegion={leadingRegionByTotal.regionName}
      />
      <RegionTileMap
        items={regionalPressure.map((region) => ({ regionName: region.regionName, value: region.supportedAsylumRate }))}
        title="Supported asylum rate by region"
        description={`${leadingRegionByRate.regionName} currently has the highest weighted rate per 10,000 residents.`}
        valueLabel="rate per 10,000"
        highlightRegion={leadingRegionByRate.regionName}
        tone="teal"
      />
    </div>
  </section>

  <section class="section section-anchor" id="route-ledger">
    <div class="section-head">
      <div>
        <h2>Full route family ledger</h2>
        <p class="lede">
          The remaining route families still matter, but they need calmer treatment once the high-volume public
          confusion is made explicit.
        </p>
      </div>
    </div>
    <div class="story-grid">
      {remainingRoutes.map((route) => (
        <article class="story-card">
          <div class="chip-row">
            <span class="chip accent">{route.group}</span>
            <span class="chip">{route.latestPeriod}</span>
          </div>
          <h3>{route.label}</h3>
          <p class="metric-value">{route.latestValue.toLocaleString()}</p>
          <p class="tiny">{route.schemeStatus}</p>
          <p class="lede">{route.note}</p>
          <p class="tiny">Local breakdown: {route.localBreakdown}</p>
          <p class="tiny">
            <a class="source-pill" href={route.sourceUrl}>Source</a>
          </p>
        </article>
      ))}
    </div>
  </section>

  <section id="local-pressure-leaders" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Local pressure leaders</h2>
        <p class="lede">
          National routes still resolve into local concentration. These tables show where specific pressures actually
          land.
        </p>
      </div>
      <span class="chip">{routeDashboard.localSnapshotDate} local snapshot</span>
    </div>
    <div class="story-grid">
      {routeDashboard.topAreasByMetric.map((metric) => (
        <article class="story-card">
          <h3>{metric.label}</h3>
          <div class="table-card">
            <table>
              <caption>Top eight local authority areas for {metric.label.toLowerCase()} in the latest local snapshot.</caption>
              <thead>
                <tr>
                  <th scope="col">Area</th>
                  <th scope="col">Value</th>
                </tr>
              </thead>
              <tbody>
                {metric.rows.slice(0, 8).map((row) => (
                  <tr>
                    <th scope="row">{row.areaName}</th>
                    <td>{row.value.toLocaleString()}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </article>
      ))}
    </div>
  </section>

  <section id="route-limits" class="section section-anchor">
    <div class="section-head">
      <div>
        <h2>Current limits</h2>
        <p class="lede">
          This is already publishable, but it is still a constrained read of the route system rather than a complete
          public operating model.
        </p>
      </div>
    </div>
    <div class="story-grid">
      {routeDashboard.limitations.map((item) => (
        <article class="story-card">
          <p class="lede">{item}</p>
        </article>
      ))}
    </div>
  </section>
</BaseLayout>
